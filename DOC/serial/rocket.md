**Comtrol(tm) RocketPort(R)/RocketModem(TM) 系列 Linux 操作系统设备驱动程序**
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

**产品概述**
----------------

此驱动程序为 Comtrol RocketPort 和 RocketModem PCI 板提供了可加载的内核驱动程序。这些板提供 2、4、8、16 或 32 个高速串行端口或调制解调器。此驱动程序同时支持一台机器中最多四个 RocketPort 或 RocketModems 板的组合。本文档假定您使用的是集成到内核源中的 RocketPort 驱动程序。

该驱动程序也可以使用通常的“make;make install”例程作为外部模块安装。此外部模块驱动程序，可从下面列出的 Comtrol 网站获取，对于更新驱动程序或将其安装到未配置此驱动程序的内核中非常有用。外部模块的安装说明包含在随附的 README 和 HW_INSTALL 文件中。

RocketPort ISA 和 RocketModem II PCI 板目前仅在此驱动程序的模块形式中受支持。

RocketPort ISA 板需要通过板上的 DIP 开关配置 I/O 端口。有关如何设置 DIP 开关的信息，请参见下面的“ISA Rocketport 板”部分。

您可以使用以下模块参数将 I/O 端口传递给驱动程序：

board1 ：第一个 ISA 板的 I/O 端口
board2 ：第二个 ISA 板的 I/O 端口
board3 ：第三个 ISA 板的 I/O 端口
board4 ：第四个 ISA 板的 I/O 端口

外部驱动程序提供了一组实用程序和脚本（可从 http://www.comtrol.com 下载），可简化 ISA 卡的配置和设置。

RocketModem II PCI 板需要在其能够运行之前将固件加载到卡中。此驱动程序仅针对此板作为模块进行了测试。

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

**安装步骤**
-----------------------

RocketPort/RocketModem PCI 卡不需要驱动程序配置，它们会自动被检测和配置。

RocketPort 驱动程序可以作为模块安装（推荐）或构建到内核中。这与其他驱动程序一样，在构建内核的过程中，通过在 Linux 源树的根目录下执行“make config”命令进行选择。

此驱动程序安装的 RocketPort/RocketModem 串行端口被分配设备主编号 46，并将被命名为 /dev/ttyRx，其中 x 是从 0 开始的端口号（例如 /dev/ttyR0、/devttyR1 等）。如果系统中安装了多个卡，则端口名称与串行端口的映射将显示在系统日志 /var/log/messages 中。

如果作为模块安装，则必须加载模块。这可以通过输入“modprobe rocket”手动完成。要在系统启动时自动加载模块，请编辑 /etc/modprobe.d/*.conf 文件并添加“alias char-major-46 rocket”行。

为了使用这些端口，必须使用 mknod 创建它们的设备名称（节点）。这只需要执行一次，系统会保留创建后的名称。要创建 RocketPort/RocketModem 设备名称，请使用命令“mknod /dev/ttyRx c 46 x”，其中 x 是从 0 开始的端口号。例如：

>mknod /dev/ttyR0 c 46 0
>mknod /dev/ttyR1 c 46 1
>mknod /dev/ttyR2 c 46 2  

Linux 脚本 MAKEDEV 会为您创建前 16 个 ttyRx 设备名称（节点）：

>/dev/MAKEDEV ttyR

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

**ISA Rocketport 板**
---------------------

在安装和使用 ISA Rocketport 卡之前，您必须分配和配置其使用的 I/O 地址。这是通过设置 Rocketport 板上的一组 DIP 开关来完成的。

**设置 I/O 地址**
-----------------------

在安装 RocketPort(R) 或 RocketPort RA 板之前，您必须为其找到一个 I/O 地址范围以供使用。第一张 RocketPort 卡需要一个 68 字节的连续 I/O 地址块，从以下之一开始：0x100h、0x140h、0x180h、0x200h、0x240h、0x280h、0x300h、0x340h、0x380h。此 I/O 地址必须反映在所有 Rocketport 卡的 DIP 开关中。

第二、第三和第四张 RocketPort 卡需要一个 64 字节的连续 I/O 地址块，从以下 I/O 地址之一开始：0x100h、0x140h、0x180h、0x1C0h、0x200h、0x240h、0x280h、0x2C0h、0x300h、0x340h、0x380h、0x3C0h。第二、第三和第四张 Rocketport 卡（如果存在）使用的 I/O 地址通过软件控制设置。I/O 地址的 DIP 开关设置必须设置为第一张 Rocketport 卡的值。

为了区分每张卡，每张卡必须在 DIP 开关上设置一个唯一的板 ID。第一张 Rocketport 板必须使用与第一张板对应的 DIP 开关进行设置，第二张板必须使用与第二张板对应的 DIP 开关进行设置，依此类推。重要提示：板 ID 是系统中不同 Rocketport 板之间 DIP 开关设置唯一应该不同的地方。

任何 RocketPort 卡使用的 I/O 地址范围都不得与系统中的任何其他卡（包括其他 RocketPort 卡）冲突。下面，您将找到系统中其他设备可能使用的常用 I/O 地址范围列表。在 Linux 系统上，“cat /proc/ioports”也有助于确定系统中设备正在使用的 I/O 地址。

请记住，第一张 RocketPort 使用 68 个 I/O 地址。因此，如果您将其设置为 0x100，它将占用 0x100 到 0x143。这意味着您不能将第二、第三或第四张板设置为地址 0x140，因为该范围的前 4 个字节已被第一张板使用。您需要将第二、第三或第四张板设置为下一个可用的块，例如 0x180。

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

RocketPort 和 RocketPort RA SW1 设置：
```
          +-------------------------------+
          | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 |
          +-------+-------+---------------+
          | 未使用| 卡     | I/O 端口块     |
          +-------------------------------+

DIP 开关                             DIP 开关

7    8                                   6    5
===================                      ===================
开   开   未使用，必须为开。                 开   开   第一张卡    <==== 默认
                                         开   关   第二张卡
                                         关   开   第三张卡
                                         关   关   第四张卡

DIP 开关         I/O 地址范围
4    3    2    1     第一张卡使用
=====================================
开   关   开   关   100-143
开   关   关   开   140-183
开   关   关   关   180-1C3       <==== 默认
关   开   开   关   200-243
关   开   关   开   240-283
关   开   关   关   280-2C3
关   关   开   关   300-343
关   关   关   开   340-383
关   关   关   关   380-3C3
```
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

**报告错误**
--------------

对于技术支持，请提供以下信息：驱动程序版本、内核版本、内核发行版以及您正在使用的板类型。错误消息和日志打印输出、端口配置详细信息尤其有帮助。

美国
    电话：(612) 494-4100
      传真：(612) 494-4199
    电子邮件：support@comtrol.com

Comtrol 欧洲
    电话：+44 (0) 1 869 323-220
      传真：+44 (0) 1 869 323-211
    电子邮件：support@comtrol.co.uk

网站：http://www.comtrol.com
FTP：ftp.comtrol.com

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-