# 设备树动态解析器注释
----------------------------------

本文档描述了内核中的设备树解析器的实现，位于 `drivers/of/resolver.c` 中，并且是 `Documentation/devicetree/dt-object-internal.txt[1]` 的配套文档。

解析器的工作原理
----------------------

解析器接收一个使用适当的 `dtc` 选项编译的任意树作为输入，并具有 `/plugin/` 标签。这会生成如 [1] 中所述的适当的 `__fixups__` 和 `__local_fixups__` 节点。

解析器按以下步骤顺序工作：

1. 从活动树中获取最大的设备树 `phandle` 值加 1。
2. 将树的所有本地 `phandles` 调整为增加该数量进行解析。
3. 使用 `__local__fixups__` 节点信息将所有本地引用按相同数量进行调整。
4. 对于 `__fixups__` 节点中的每个属性，在活动树中定位它引用的节点。这是用于标记节点的标签。
5. 检索修复目标的 `phandle` 。
6. 对于属性中的每个修复，定位节点:属性:偏移位置，并将其替换为 `phandle` 值。